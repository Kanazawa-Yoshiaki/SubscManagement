version: '3'

services:
    db:
        image: mysql:8.0
        restart: always
        hostname: subsc-mysql-container
        environment:
            MYSQL_ROOT_PASSWORD: password
            MYSQL_USER: apuser
            MYSQL_PASSWORD: password
            MYSQL_DATABASE: subscManagement
            TZ: "Asia/Tokyo"
            BIND-ADDRESS: 0.0.0.0
        ports:
            - 3306:3306
        volumes:
            - ./db/mysql_data:/var/lib/mysql
        tty: true
        networks:
            app_net:
                ipv4_address: 172.20.0.3
        depends_on:
            - django

    django:
        build: .
        hostname: subsc-django-container
        ports:
            - "8000:8000"
        volumes:
            - ./app:/app
        networks:
            app_net:
                ipv4_address: 172.20.0.2
        tty: true

networks:
    app_net:
        driver: bridge
        ipam:
            driver: default
            config:
            - subnet: 172.20.0.0/24